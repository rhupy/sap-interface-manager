# SAP Interface Manager

## ÌîÑÎ°úÏ†ùÌä∏ Í∞úÏöî

**SAP Interface Manager**Îäî **React**ÏôÄ **Electron**ÏùÑ ÏÇ¨Ïö©ÌïòÏó¨ Íµ¨ÌòÑÎêú Îç∞Ïä§ÌÅ¨ÌÉëÏï±ÏûÖÎãàÎã§.
`ÏßÅÍ¥ÄÏ†ÅÏù∏ GUI`Î•º Ï†úÍ≥µÌï©ÎãàÎã§.\
Í∞úÏù∏ Ï∑®ÎØ∏Î°ú Í∞úÎ∞úÎêú Ïï±Ïù¥Î©∞, ÏùºÎ∂Ä ÏïÑÏßÅ Í∏∞Îä•ÏùÄ Íµ¨ÌòÑÌïòÏßÄ ÏïäÏïòÏúºÎÇò Ï†ÑÏ≤¥Ï†ÅÏù∏ ÌîÑÎ°úÏÑ∏Ïä§Îäî Íµ¨ÌòÑÎêòÏóàÏäµÎãàÎã§.

`SAP`ÏôÄ, `Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§`ÏôÄ Ïó∞ÎèôÌïòÏó¨ Îç∞Ïù¥ÌÑ∞Î•º ÏÜ°/ÏàòÏã†ÌïòÎ©∞, ÎπÑÏßÄÎãàÏä§ Î°úÏßÅÏóê Îî∞Îùº `Ïù∏ÌÑ∞ÌéòÏù¥Ïä§ Í¥ÄÎ¶¨`, `ÏûêÎèô Ïä§ÏºÄÏ§ÑÎßÅ`, `Ïã§ÏãúÍ∞Ñ Î°úÍπÖ` Îì±Ïùò Í∏∞Îä•ÏùÑ Ï†úÍ≥µÌï©ÎãàÎã§.\
Ïù¥ ÎèÑÍµ¨Îäî RFC Î∞è Oracle Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ ÏàòÏ†ï ÏûëÏóÖ Îì± Î™®Îì† `ÏûëÏóÖ Îã®ÏúÑ`Î•º `Î™®ÎìàÌôî`Ìï©ÎãàÎã§.\
Îç∞Ïù¥ÌÑ∞ Ïù∏ÌÑ∞ÌéòÏù¥Ïä§Î•º Íµ¨Ï∂ïÌïòÎäîÎç∞ ÏûàÏñ¥ Í∞úÎ∞ú Ïä§ÌÇ¨ÏùÑ ÏöîÍµ¨ÌïòÏßÄ ÏïäÍ≥†ÎèÑ, ÏÜåÏä§ ÏΩîÎìú ÏûëÏÑ±ÏóÜÏù¥ Îã§ÏñëÌïú `Ïù∏ÌÑ∞ÌéòÏù¥Ïä§ Íµ¨ÌòÑ`Í≥º Ìé∏Î¶¨Ìïú `Ïú†ÏßÄÎ≥¥Ïàò`Î∞è `ÌôïÏû•ÏÑ±` ÏùÑ Ï†úÍ≥µÌï©ÎãàÎã§.

## üöÄ Ï£ºÏöî Í∏∞Îä•

- **SAP Ïó∞Îèô**: RFCÎ•º ÌÜµÌï¥ SAP ÏãúÏä§ÌÖúÍ≥º Ïó∞Í≤∞ÌïòÏó¨ Îç∞Ïù¥ÌÑ∞Î•º ÏÜ°/ÏàòÏã†Ìï©ÎãàÎã§.
- **Oracle DB Ïó∞Îèô**: Oracle DBÏóê Îç∞Ïù¥ÌÑ∞Î•º ÏÇΩÏûÖ Î∞è ÏóÖÎç∞Ïù¥Ìä∏Ìï©ÎãàÎã§.
- **Ïù∏ÌÑ∞ÌéòÏù¥Ïä§ Í¥ÄÎ¶¨**: Îã§ÏñëÌïú Ïù∏ÌÑ∞ÌéòÏù¥Ïä§Î•º Í¥ÄÎ¶¨ÌïòÍ≥† ÏÑ§Ï†ïÌï† Ïàò ÏûàÏäµÎãàÎã§.
- **Ïä§ÏºÄÏ§ÑÎßÅ & ÏûêÎèôÌôî**: ÏûëÏóÖÏùÑ ÏòàÏïΩÌïòÍ≥† ÏûêÎèôÌôîÌï† Ïàò ÏûàÏäµÎãàÎã§.
- **Ïã§ÏãúÍ∞Ñ Î°úÍπÖ ÌÑ∞ÎØ∏ÎÑê**: Ïã§ÏãúÍ∞ÑÏúºÎ°ú Î°úÍ∑∏Î•º ÏàòÏßëÌïòÍ≥† Î™®ÎãàÌÑ∞ÎßÅÌï©ÎãàÎã§.

## üõ†Ô∏è ÏÇ¨Ïö© Í∞ÄÏù¥Îìú

![ÏÇ¨Ïö©Ïûê ÌîÑÎ°úÏÑ∏Ïä§](public/guide.png)

1. ÌôòÍ≤ΩÏÑ§Ï†ï

   - RFC Ï†ëÏÜçÏ†ïÎ≥¥ ÏÑ∏ÌåÖ
   - DB Ï†ëÏÜçÏ†ïÎ≥¥ ÏÑ∏ÌåÖ
   - Î°úÍ∑∏ ÌååÏùº ÏÉùÏÑ± Í≤ΩÎ°ú Î≥ÄÍ≤Ω

     ![ÏÇ¨Ïö©Ïûê ÌîÑÎ°úÏÑ∏Ïä§](public/config.png)

     RFC / DB Ïó∞Í≤∞ Ï†ïÎ≥¥Î•º Í∏∞ÏûÖ ÌõÑ Ï†ëÏÜç ÌÖåÏä§Ìä∏ Î∞è ÏÑ§Ï†ïÏùÑ Ï†ÄÏû•Ìï©ÎãàÎã§.\
      RFCÎßå ÏÇ¨Ïö©ÌïòÍ±∞ÎÇò DBÎßå ÏÇ¨Ïö©ÌïòÎäî Í≤ΩÏö∞ ÌïúÏ™ΩÎßå ÏÑ§Ï†ïÌï¥ÎèÑ Î¨¥Í¥ÄÌï©ÎãàÎã§.\
      Ï†ëÏÜç Ï†ïÎ≥¥ ÏûÖÎ†• ÌõÑ Ïó∞Í≤∞ Ï∂îÍ∞Ä Î≤ÑÌäºÏùÑ ÎàÑÎ•¥Î©¥ ÏÉàÎ°úÏö¥ Ïó∞Í≤∞ÏÑ§Ï†ïÏúºÎ°ú Ï∂îÍ∞ÄÎê©ÎãàÎã§.\
      Ïó∞Í≤∞ Ïù¥Î¶ÑÏùÄ Ï§ëÎ≥µÎê† Ïàò ÏóÜÏäµÎãàÎã§. (Í≥†Ïú†Î™Ö)\
      Í∏∞Ï°¥ Ïó∞Í≤∞ÏÑ§Ï†ïÏùÑ ÏÑ†ÌÉùÌïú ÌõÑ ÏàòÏ†ïÏùÑ ÎàÑÎ•¥Î©¥ ÏóÖÎç∞Ïù¥Ìä∏Îê©ÎãàÎã§.

   - ÏÑ§Ï†ï Î∞±ÏóÖ ÌïòÍ∏∞\
     Ïù¥ Ïï±ÏóêÏÑú ÏÑ§Ï†ïÌïú Î™®Îì† Ï†ïÎ≥¥Îäî setting.json ÌååÏùºÏóêÏÑú Ïú†ÏßÄÌï©ÎãàÎã§.\
     ÌôòÍ≤ΩÏÑ§Ï†ï ÌéòÏù¥ÏßÄÏùò Ïö∞ÏÉÅÎã®Ïóê ÏúÑÏπòÌïú ÏÑ§Ï†ï ÌååÏùº Ïó¥Í∏∞ Î≤ÑÌäºÏùÑ ÎàÑÎ•¥Î©¥ setting.json ÌååÏùºÏùÑ ÏßÅÏ†ë ÌôïÏù∏Ìï† Ïàò ÏûàÏäµÎãàÎã§.\
     ÌïÑÏöîÌïú Í≤ΩÏö∞ Ìï¥Îãπ ÌååÏùºÏùÑ Î∞±ÏóÖÌïòÏó¨ ÌÉÄ PCÏùò setting.json ÏóêÍ≤å pasteÌïòÎ©¥ ÎèôÏùºÌïú ÏÑ∏ÌåÖÏúºÎ°ú Î∞∞Ìè¨Îê©ÎãàÎã§.

2. ÏûëÏóÖ Îã®ÏúÑ ÏÉùÏÑ±

   - RFC Í¥ÄÎ¶¨

     - RFC ÌååÎùºÎØ∏ÌÑ∞ ÏÑ∏ÌåÖ
     - RFC ÌÖåÏä§Ìä∏

       ![ÏÇ¨Ïö©Ïûê ÌîÑÎ°úÏÑ∏Ïä§](public/rfc.png)

   - SQL Í¥ÄÎ¶¨

     - SQLÎ¨∏ ÏÉùÏÑ±, ÏûÖ/Ï∂úÎ†• ÌååÎùºÎØ∏ÌÑ∞ ÏßÄÏ†ï

       ![ÏÇ¨Ïö©Ïûê ÌîÑÎ°úÏÑ∏Ïä§](public/sql.png)
       DB Ïó∞Í≤∞ÏùÑ ÏÇ¨Ïö©ÌïòÎäî Í≤ΩÏö∞ (ÌòÑÏû¨ Ïò§ÎùºÌÅ¥Îßå ÏßÄÏõê) SQL Í¥ÄÎ¶¨ ÌéòÏù¥ÏßÄÏóêÏÑú SQL Î¨∏ÏùÑ ÏÉùÏÑ±Ìï©ÎãàÎã§.

       ```bash
       INSERT INTO
       TEST_TABLE (DATA1, DATA2, DATA3, DATA4)
       VALUES
       (
         ::DATA1,
         ::DATA2,
         ::DATA3,
         ::DATA4
       );
       ```

       ÏûÖÎ†• ÌååÎùºÎØ∏ÌÑ∞Í∞Ä ÌïÑÏöîÌïú Í≤ΩÏö∞ ÏûÑÏùòÏùò ÌååÎùºÎØ∏ÌÑ∞Î™Ö ÏïûÏóê '::'Î•º ÏûÖÎ†•Ìï©ÎãàÎã§.\
        ÏúÑÏùò ÏòàÏ†úÏóêÏÑúÎäî 4Í∞úÏùò ÌååÎùºÎØ∏ÌÑ∞Í∞Ä ÏÑ§Ï†ïÎê©ÎãàÎã§.

   - ÌîÑÎ°úÏÑ∏Ïä§ Í¥ÄÎ¶¨ (ÎØ∏Í∞úÎ∞ú)
     - Ï°∞Í±¥ Î∂ÑÍ∏∞ / RFC, SQL Ïô∏ ÌäπÏàò ÎèôÏûë ÏÑ§Ï†ï

3. Ïù∏ÌÑ∞ÌéòÏù¥Ïä§ Í¥ÄÎ¶¨

   - ÏÉùÏÑ±Îêú ÏûëÏóÖ Îã®ÏúÑ(RFC, SQL) Î•º ÏÑ†ÌÉùÌïòÏó¨ Ïù∏ÌÑ∞ÌéòÏù¥Ïä§Î•º Íµ¨ÏÑ±

     ![ÏÇ¨Ïö©Ïûê ÌîÑÎ°úÏÑ∏Ïä§](public/if.png)

   - ÌïÑÏöîÌïòÎã§Î©¥ ÏûëÏóÖÍ∞Ñ ÌååÎùºÎØ∏ÌÑ∞Î•º Îß§Ìïë

     ![ÏÇ¨Ïö©Ïûê ÌîÑÎ°úÏÑ∏Ïä§](public/if2.png)

     `RFC Í¥ÄÎ¶¨`ÏôÄ `Ïù∏ÌÑ∞ÌéòÏù¥Ïä§ Í¥ÄÎ¶¨`ÏóêÏÑú ÏÉùÏÑ±Ìïú ÏûëÏóÖ Îã®ÏúÑÎì§ÏùÑ Ïù¥Ïö©Ìï¥ ÌïòÎÇòÏùò Ïù∏ÌÑ∞ÌéòÏù¥Ïä§ Î°úÏßÅÏùÑ ÏÉùÏÑ±ÌïòÎäî ÌéòÏù¥ÏßÄ ÏûÖÎãàÎã§.\
      ÌÉÄÏù¥ÌãÄ(Í≥†Ïú†Î™Ö) ÏùÑ Ï†ïÏùòÌïòÍ≥†, ÏûëÏóÖÍ¥ÄÎ¶¨ÏóêÏÑú RFC ÎÇò SQL ÏùÑ ÏÑ†ÌÉùÌïúÎí§ ÏûëÏóÖÏùÑ ÏÑ†ÌÉùÌï©ÎãàÎã§.\
      ÏõêÌïúÎã§Î©¥ ÏûëÏóÖÏù¥Î¶ÑÏùÑ ÏûÑÏùòÎ°ú Ï†ïÌï† Ïàò ÏûàÏäµÎãàÎã§.\
      ÏûëÏóÖÏùÑ Ï∂îÍ∞ÄÌïòÎ©¥ ÌïòÎã®Ïùò ÏûëÏóÖÎ™©Î°ùÏóê Ìï¥Îãπ ÏûëÏóÖÏù¥ Ï∂îÍ∞Ä Îê©ÎãàÎã§.\
      Îß§ÌïëÏùÑ ÎàåÎü¨ ÏûÖ/Ï∂úÎ†• ÌååÎùºÎØ∏ÌÑ∞Î•º Ïó∞Í≥ÑÌï† Ïàò ÏûàÏäµÎãàÎã§.\
      ÏûëÏóÖÏùÄ ÏúÑÏóêÏÑúÎ∂ÄÌÑ∞ ÏàúÏÑúÎåÄÎ°ú ÏßÑÌñâÎêòÍ∏∞ ÎïåÎ¨∏Ïóê ÏïûÏùò ÏûëÏóÖÏóêÏÑú ÏÉùÏÑ±Ìïú Î™®Îì† Ï∂úÎ†• ÌååÎùºÎØ∏ÌÑ∞Îì§ÏùÄ ÏïÑÎûòÏùò Î™®Îì† ÏûëÏóÖÎì§ÏóêÏÑú Îß§ÌïëÌïòÏó¨ ÏÇ¨Ïö©Ìï† Ïàò ÏûàÏäµÎãàÎã§.

4. ÌîÑÎ°úÏ†ùÌä∏ Í¥ÄÎ¶¨

   - ÏÉùÏÑ±Îêú Ïù∏ÌÑ∞ÌéòÏù¥Ïä§Î•º ÌïòÎÇòÏùò ÌîÑÎ°úÏ†ùÌä∏ Îã®ÏúÑÎ°ú ÏÉùÏÑ±
   - Ïã§ÏãúÍ∞Ñ Î™®ÎãàÌÑ∞ÎßÅÍ≥º Î°úÍπÖ
   - Ïù∏ÌÑ∞ÌéòÏù¥Ïä§ ÏûêÎèô Ïä§ÏºÄÏ§ÑÎßÅ
   - ÌîÑÎ°úÏ†ùÌä∏ Îã®ÏúÑÎ°ú Ïã§Ìñâ Î∞è Í¥ÄÎ¶¨

     ![ÏÇ¨Ïö©Ïûê ÌîÑÎ°úÏÑ∏Ïä§](public/prj.gif)

## üõ†Ô∏è ÏÑ§Ïπò

### ÌïÑÏàò Ï°∞Í±¥

- **Oracle DB ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏** (oracledb Ìå®ÌÇ§ÏßÄ ÏÇ¨Ïö©ÏùÑ ÏúÑÌï¥)
- **SAP RFC SDK** (v7.50)

### Ï†ÄÏû•ÏÜå ÌÅ¥Î°† Ïãú

```bash
git clone https:://github.com/rhupy/sap-interface-manager.git
cd sap-interface-manager
```

- **Node.js** (v16.x Ïù¥ÏÉÅ)
- **npm** (v7.x Ïù¥ÏÉÅ)

### Oracle DB ÏÇ¨Ïö© Ïãú, Îã§Ï§ë SQLÎ¨∏ Ï≤òÎ¶¨Î•º ÏúÑÌïú ÏïÑÎûò Stored Procedure Î•º ÏÇ¨Ï†Ñ ÏÉùÏÑ± (EXEC_MULTI_DATA_SQL)

```bash
CREATE OR REPLACE PROCEDURE EXEC_MULTI_DATA_SQL(
  p_json_data CLOB,
  p_sql_template CLOB,
  p_column_mappings CLOB,
  p_regular_params CLOB
) AS
  v_sql CLOB;
  v_data_count NUMBER;
  v_current_sql CLOB;
  v_column_name VARCHAR2(100);
  v_column_value VARCHAR2(4000);
  v_param_name VARCHAR2(100);
  v_param_value VARCHAR2(4000);
BEGIN
  -- Îç∞Ïù¥ÌÑ∞ Ìñâ Ïàò Í≥ÑÏÇ∞
  SELECT COUNT(*)
  INTO v_data_count
  FROM JSON_TABLE(p_json_data, '$[*]'
    COLUMNS (dummy PATH '$.MATNR'));

  v_current_sql := p_sql_template;

  -- ÏùºÎ∞ò ÌååÎùºÎØ∏ÌÑ∞ ÎåÄÏ≤¥
  IF p_regular_params IS NOT NULL THEN
    FOR param IN (SELECT param_name, param_value
                  FROM JSON_TABLE(p_regular_params, '$[*]' COLUMNS (
                    param_name VARCHAR2(100) PATH '$.param_name',
                    param_value VARCHAR2(4000) PATH '$.param_value'
                  ))) LOOP
      v_param_name := param.param_name;
      v_param_value := param.param_value;
      -- Í∞íÏù¥ Î¨∏ÏûêÏó¥Ïù¥Î©¥ Îî∞Ïò¥Ìëú Ï∂îÍ∞Ä
      IF REGEXP_LIKE(v_param_value, '^[0-9]+(\.[0-9]+)?$') THEN
        v_current_sql := REPLACE(v_current_sql, '::' || v_param_name, v_param_value);
      ELSE
        v_current_sql := REPLACE(v_current_sql, '::' || v_param_name, '''' || REPLACE(v_param_value, '''', '''''') || '''');
      END IF;
      DBMS_OUTPUT.PUT_LINE('Regular param replaced: ::' || v_param_name || ' -> ' || v_param_value);
    END LOOP;
  END IF;

  -- Í∞Å Îç∞Ïù¥ÌÑ∞ Ìñâ Ï≤òÎ¶¨
  FOR i IN 0..v_data_count-1 LOOP
    v_sql := v_current_sql;

    FOR mapping IN (SELECT param_name, json_path
                    FROM JSON_TABLE(p_column_mappings, '$[*]' COLUMNS (
                      param_name VARCHAR2(100) PATH '$.param_name',
                      json_path VARCHAR2(100) PATH '$.json_path'
                    ))) LOOP
      v_column_name := mapping.param_name;
      v_column_value := JSON_VALUE(p_json_data, '$[' || i || '].' || mapping.json_path);

      IF v_column_value IS NULL THEN
        v_column_value := 'NULL';
      ELSE
        IF REGEXP_LIKE(v_column_value, '^[0-9]+(\.[0-9]+)?$') = FALSE THEN
          v_column_value := '''' || REPLACE(v_column_value, '''', '''''') || '''';
        END IF;
      END IF;

      v_sql := REPLACE(v_sql, '::' || v_column_name, v_column_value);
      DBMS_OUTPUT.PUT_LINE('Column replaced: ::' || v_column_name || ' -> ' || v_column_value);
    END LOOP;

    -- ÏÉùÏÑ±Îêú SQL Ï∂úÎ†• Î∞è Ïã§Ìñâ
    DBMS_OUTPUT.PUT_LINE('Generated SQL: ' || v_sql);
    EXECUTE IMMEDIATE v_sql;
  END LOOP;

  COMMIT;
EXCEPTION
  WHEN OTHERS THEN
    ROLLBACK;
    RAISE_APPLICATION_ERROR(-20001, 'Error in EXEC_MULTI_DATA_SQL: ' || SQLERRM);
END;
```
